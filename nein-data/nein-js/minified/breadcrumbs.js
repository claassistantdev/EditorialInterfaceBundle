YUI.add("ez-breadcrumbs",function(e){"use strict";function n(e){n.superclass.constructor.apply(this,arguments)}e.namespace("eZ");var t=e.Lang;n.NAME="breadcrumbs",n.CSS_PREFIX="ez-ei",n.ATTRS={callerID:{value:""},focusedNode:{value:""},linkClickCallback:{value:""},closeClickCallback:{value:""},breadCrumbsCloseLinkId:{value:"-breadcrumbs-close"},breadCrumbsId:{value:"-breadcrumbs"},breadCrumbsRootId:{value:"-breadcrumbs-root"},breadCrumbsPathId:{value:"-breadcrumbs-path"},breadCrumbsPathStepClass:{value:"-breadcrumbs-path-step"},breadCrumbsPlugId:{value:"-breadcrumbs-plug"},breadCrumbsCurrentId:{value:"-breadcrumbs-current"},breadCrumbsLinkClass:{value:"-breadcrumbs-link"}},n.HTML_PARSER={},e.extend(n,e.Widget,{initializer:function(){var t=n.CSS_PREFIX,r=e.one("#ezp-nein-dialog-breadcrumbs").getHTML(),i=e.Handlebars.compile(r),s=e.one("#ezp-nein-dialog-breadcrumbs-step").getHTML();this.breadcrumbsStepTemplate=e.Handlebars.compile(s),this.showOnlyMarkers=!1,this.focusedNode=this.get("focusedNode"),this._linkClickCallback=this.get("linkClickCallback"),this._closeClickCallback=this.get("closeClickCallback"),this.uniqueClass="for-"+this.get("callerID"),this.sourceNode=this.get("srcNode"),this.sourceNode.setHTML(i({cssPrefix:t,uniqueClass:this.uniqueClass})),this.sourceNode.delegate("click",this._linkClick,"."+t+this.get("breadCrumbsLinkClass")+"."+this.uniqueClass,this),this.sourceNode.delegate("click",this._closeClick,"."+t+this.get("breadCrumbsCloseLinkId")+"."+this.uniqueClass,this)},destructor:function(){},renderUI:function(){},bindUI:function(){},syncUI:function(){},update:function(t){this.focusedNode=t;var r=e.one("."+n.CSS_PREFIX+this.get("breadCrumbsId")+"."+this.uniqueClass),i=e.one("."+n.CSS_PREFIX+this.get("breadCrumbsCurrentId")+"."+this.uniqueClass);this.showOnlyMarkers=!1,this._syncNodes(),i.getY()>r.getY()&&(this.showOnlyMarkers=!0,this._syncNodes())},_syncNodes:function(){var t=n.CSS_PREFIX,r=e.one("."+t+this.get("breadCrumbsPathId")+"."+this.uniqueClass),i=e.one("."+t+this.get("breadCrumbsCurrentId")+"."+this.uniqueClass),s=e.one("."+t+this.get("breadCrumbsPlugId")+"."+this.uniqueClass);r.empty(),i.setHTML(this.focusedNode.getAttribute("data-ez-editable-region-marker")+". "+this.focusedNode.getAttribute("data-ez-field-identifier"));var o=e.one("#"+this.focusedNode.getAttribute("data-ez-editable-region-parent")),u;while(o){u=o;var a=this.showOnlyMarkers?"":" "+u.getAttribute("data-ez-field-identifier");r.prepend(e.Node.create(this.breadcrumbsStepTemplate({cssPrefix:t,uniqueClass:this.uniqueClass,rel:u.getAttribute("id"),marker:u.getAttribute("data-ez-editable-region-marker"),label:a}))),o=e.one("#"+u.getAttribute("data-ez-editable-region-parent"))}this.focusedNode.getAttribute("data-ez-editable-region-parent")?s.removeClass("white"):s.addClass("white")},_linkClick:function(t){t.preventDefault();var n=t.currentTarget._node;this._linkClickCallback(e.one("#"+n.getAttribute("rel")))},_closeClick:function(e){e.preventDefault(),this._closeClickCallback()}}),e.eZ.Breadcrumbs=n},"0.1alpha",["widget"]);